<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.79.1"><link rel=canonical type=text/html href=https://docs.opulo.io/openpnp/calibration/><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Calibration | Opulo Docs</title><meta property="og:title" content="Calibration"><meta property="og:description" content="Connect your LumenPnP to OpenPNP and perform basic calibration."><meta property="og:type" content="website"><meta property="og:url" content="https://docs.opulo.io/openpnp/calibration/"><meta property="og:site_name" content="Opulo Docs"><meta itemprop=name content="Calibration"><meta itemprop=description content="Connect your LumenPnP to OpenPNP and perform basic calibration."><meta name=twitter:card content="summary"><meta name=twitter:title content="Calibration"><meta name=twitter:description content="Connect your LumenPnP to OpenPNP and perform basic calibration."><link rel=preload href=/scss/main.min.6e2cb561824c915a611c33d11e67c1c89afe613f885f5966c1c0dfb47794e3f8.css as=style><link href=/scss/main.min.6e2cb561824c915a611c33d11e67c1c89afe613f885f5966c1c0dfb47794e3f8.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.0" width="50" height="50" viewBox="0 0 37.5 37.5" id="svg2015" sodipodi:docname="logo.svg" inkscape:version="0.92.2 5c3e80d, 2017-08-06"><defs id="defs2019"/><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="1736" inkscape:window-height="1074" id="namedview2017" showgrid="false" inkscape:zoom="17.22" inkscape:cx="25" inkscape:cy="25" inkscape:window-x="0" inkscape:window-y="0" inkscape:window-maximized="0" inkscape:current-layer="g2013" units="px"/><g transform="matrix(0.1,0,0,-0.1,0,37.5)" id="g2013" style="fill:#000;stroke:none"><path d="M0 187.5V0H187.5 375V187.5 375H187.5.0zm200.33333 171.16667c1-1 1.33334-3.08334 1.33334-8.58334V342.75l5.25-.58333c23.25-2.66667 51.41666-13.58334 71.41666-27.83334 10.16667-7.16666 28-25 35.16667-35.16666 14.25-20 25.16667-48.16667 27.83333-71.41667l.58334-5.25H349.25c10.08333.0 9.91667.25 9.91667-14.58333.0-14.83334.16666-14.58334-9.91667-14.58334h-7.33333l-.58334-5.16666c-1.75-15.58334-6.75-32.16667-14.25-47.83334C311.66667 88.083333 288.83333 64.833333 256.75 48.75c-15.08333-7.5-34-13.25-49.83333-15l-5.25-.583333v-7.333334c0-10.166666.25-10-14.58334-10C172.25 15.833333 172.5 15.666667 172.5 25.75v7.333333l-5.16667.583334c-16.25 1.833333-34.41666 7.5-51.25 15.916666C99.833333 57.833333 90.25 64.75 77.083333 77.916667 63.916667 91.083333 57 100.66667 48.75 116.91667 40.166667 134 34.666667 151.83333 32.833333 168.16667L32.25 173.33333H24.916667C14.833333 173.33333 15 173.08333 15 187.91667 15 202.75 14.833333 202.5 24.916667 202.5H32.25l.583333 5.25c1.833334 16.25 7.333334 34.08333 15.916667 51.16667 8.25 16.25 15.166667 25.83333 28.333333 39C90.25 311.08333 99.833333 318 116.08333 326.25c17 8.58333 34.58334 14 51.25 15.91667L172.5 342.75v7.33333c0 10.08334-.25 9.91667 14.58333 9.91667 9.75.0 12.16667-.25 13.25-1.33333z" id="path2005" style="fill:none;stroke-width:.08333334" inkscape:connector-curvature="0"/><path d="m177.5 347.08333c0-9.91666.83333-9.08333-9.16667-10C141.41667 334.5 110.25 320.5 87.833333 300.91667 61 277.58333 42.333333 242.83333 38.25 209 36.75 196.16667 38 197.5 27.916667 197.5h-8.75v-9.58333-9.58334h8.75c10 0 8.833333 1.33334 10.333333-11.33333C42.333333 132.91667 61.5 97.5 88.333333 74.416667 110.91667 55.083333 141.75 41.333333 168.33333 38.75c10-.916667 9.16667-.08333 9.16667-10V20h9.58333 9.58334v8.75c0 10.083333-1.33334 8.833333 11.5 10.333333 42.5 5.083334 84.25 32.416667 107.16666 70.249997 11 18.08334 19.16667 41.5 20.91667 59.83334.91667 10 .0833 9.16666 10 9.16666H355v9.58334 9.58333h-8.75c-9.91667.0-9.08333-.83333-10 9.16667-1.91667 20.08333-11.75 46.5-24.33333 65.16666C288.33333 307 248.5 331.91667 208.16667 336.75c-12.83334 1.5-11.5.25-11.5 10.33333v8.75H187.08333 177.5zm0-70V235h9.58333 9.58334v42 42l4-.41667C221.33333 316.5 245 307.66667 262.58333 295.41667c9.83334-6.83334 26.58334-23.91667 33.16667-33.75 12-18.08334 20-39.91667 22-60.16667l.41667-4H303.25 288.33333v-9.58333-9.58334h15 15L318 176.5c-.25-1.08333-.66667-4.08333-.91667-6.75C316.25 162 312.75 148.91667 309.16667 139.66667 296.25 106.66667 268.33333 78.75 235.33333 65.833333 226.08333 62.25 213 58.75 205.25 57.916667 202.58333 57.666667 199.58333 57.25 198.58333 57l-1.91666-.333333v15 15H187.08333 177.5v-15-15L175.66667 57c-1.08334.25-4.08334.666667-6.75.916667C166.25 58.25 160.25 59.416667 155.66667 60.5 106.83333 72.333333 68.166667 112.75 58.5 162.08333c-.916667 4.58334-1.833333 10.08334-2.083333 12.33334L56 178.33333h42 42V187.91667 197.5H98 55.916667l.416666 3.16667c4.166667 32.25 15.5 56.58333 36.333334 78.16666 9.750003 10.08334 18.250003 16.66667 30.083333 23.5 13.5 7.75 32 13.91667 47.66667 15.91667 3.25.33333 6.08333.75 6.5.83333.33333.0.58333-18.83333.58333-42z" id="path2007" style="fill:#fff;fill-opacity:1;stroke-width:.08333334" inkscape:connector-curvature="0"/><path d="M162.33333 311.66667C117.58333 302.25 80.666667 269.08333 66.833333 225.83333 64.75 219.16667 61.666667 205.91667 61.666667 203.25c0-.41667 17.166666-.75 39.916663-.75 35.25.0 40.08334-.16667 41.25-1.33333 1.08334-1.08334 1.33334-3.5 1.33334-13.25s-.25-12.16667-1.33334-13.25c-1.16666-1.16667-6-1.33334-41.25-1.33334-22.749997.0-39.916663-.33333-39.916663-.75.0-2.66666 3.083333-15.91666 5.166666-22.58333C79.166667 111.58333 110.75 80 149.16667 67.666667 155.83333 65.583333 169.08333 62.5 171.75 62.5c.41667.0.75 6 .75 13.25.0 11 .25 13.5 1.33333 14.583333 1.91667 1.916667 24.58334 1.916667 26.5.0C201.41667 89.25 201.66667 86.75 201.66667 75.75c0-7.25.33333-13.25.75-13.25 2.66666.0 15.91666 3.083333 22.58333 5.166667C263.41667 80 295 111.58333 307.33333 150c2.08334 6.66667 5.16667 19.91667 5.16667 22.58333.0.41667-6 .75-13.25.75-11 0-13.5.25-14.58333 1.33334-1.08334 1.08333-1.33334 3.5-1.33334 13.25s.25 12.16666 1.33334 13.25C285.75 202.25 288.25 202.5 299.25 202.5c7.25.0 13.25.33333 13.25.75.0 2.66667-3.08333 15.91667-5.16667 22.58333-6.16666 19.25-16.41666 35.83334-31.41666 50.91667C260.83333 291.75 244.25 302 225 308.16667c-6.66667 2.08333-19.91667 5.16666-22.58333 5.16666-.41667.0-.75-17.16666-.75-39.91666.0-35.25-.16667-40.08334-1.33334-41.25-1.91666-1.91667-24.58333-1.91667-26.5.0-1.16666 1.16666-1.33333 6-1.33333 41.25.0 37.5-.0833 39.91666-1.41667 39.83333-.83333.0-4.75-.75-8.75-1.58333zm38-89.66667c1.08334-1 1.33334-3.25 1.33334-10.41667V202.5H210.75c7.16667.0 9.41667-.25 10.41667-1.33333 1.91666-1.91667 1.91666-24.58334.0-26.5-1-1.08334-3.25-1.33334-10.41667-1.33334h-9.08333V164.25c0-7.16667-.25-9.41667-1.33334-10.41667-1.08333-1.08333-3.5-1.33333-13.25-1.33333s-12.16666.25-13.25 1.33333c-1.08333 1-1.33333 3.25-1.33333 10.41667v9.08333h-9.08333c-7.16667.0-9.41667.25-10.41667 1.33334-1.91667 1.91666-1.91667 24.58333.0 26.5 1 1.08333 3.25 1.33333 10.41667 1.33333H172.5v9.08333c0 7.16667.25 9.41667 1.33333 10.41667 1.91667 1.91667 24.58334 1.91667 26.5.0z" id="path2009" style="fill:none;stroke-width:.08333334" inkscape:connector-curvature="0"/><path d="M177.5 207.91667V197.5h-10.41667-10.41666v-9.58333-9.58334H167.08333 177.5V167.91667 157.5h9.58333 9.58334v10.41667 10.41666H207.08333 217.5v9.58334V197.5h-10.41667-10.41666v10.41667 10.41666H187.08333 177.5z" id="path2011" inkscape:connector-curvature="0" style="stroke-width:.08333334;fill:#fff;fill-opacity:1"/></g></svg></span><span class="text-uppercase font-weight-bold">Opulo Docs</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/semi-assembly/><span>LumenPnP Semi Assembly</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/><span>LumenPnP Kit Assembly</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/openpnp/><span class=active>OpenPnP</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/troubleshooting/><span>Troubleshooting</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/maintenance-upgrades/><span>Maintenance and Upgrades</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.bb978d6c6be202cd5c3131497105dd91.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This the multi-page printable view of this section.
<a href=# onclick="print();return false;">Click here to print</a>.</p><p><a href=/openpnp/calibration/>Return to the regular view of this page</a>.</p></div><h1 class=title>Calibration</h1><div class=lead>Connect your LumenPnP to OpenPNP and perform basic calibration.</div><ul><li>1: <a href=#pg-fff92e6abd22043b863f6b6c748d7042>Importing Config Files</a></li><li>2: <a href=#pg-9aa5243beec8d65dee67c05faf8bfc04>Connecting to Your Machine</a></li><li>3: <a href=#pg-aaf9170e03c8b8784391d0b712f079b1>Camera Fisheye Calibration</a></li><li>4: <a href=#pg-bf04f0f3afaabb8259c1b63c7a4b487a>Homing Fiducial</a></li><li>5: <a href=#pg-358773e9a017901b2175f788046eb4f3>MM/pixel Calibration</a></li><li>6: <a href=#pg-88d0c5fd796be92ce5c7b6b01ec9223b>Backlash Compensation</a></li><li>7: <a href=#pg-dccf766af7ea1fcd6571d19ee9d7f8be>Nozzle Offset Calibration</a></li><li>8: <a href=#pg-a8eacac727b6db3e7a96dfb9e4f9cb5d>Bottom Camera Position</a></li><li>9: <a href=#pg-c944bf2771b5f1963cba78785de863e1>Automatic Toolchanger Calibration</a></li></ul><div class=content><h2 id=what-youll-learn><strong>What you&rsquo;ll learn</strong></h2><p>This guide is focused on performing basic calibration for your LumenPnP. Specifically it will test the motion system, and calibrate the cameras so that they can identify objects and apply offsets to the toolhead for precise part picking and placing. These steps are usually only necessary when first setting up a LumenPnP for the first time.</p><h2 id=what-youll-need><strong>What you&rsquo;ll need</strong></h2><ul><li>A LumenPnP with the mechanical and electrical build completed.</li><li>Read through the <a href=https://github.com/openpnp/openpnp/wiki/User-Manual>OpenPnP Wiki</a>. It&rsquo;ll be super important to getting going with your machine. <strong>These docs are meant to augment the OpenPnP docs, not replace them.</strong></li></ul></div></div><div class=td-content style=page-break-before:always><h1 id=pg-fff92e6abd22043b863f6b6c748d7042>1 - Importing Config Files</h1><div class=lead>Install OpenPNP and import default config</div><p>To use OpenPnP with the LumenPnP, you will need to tell the software about your machine&rsquo;s capabilities, such as it&rsquo;s size, how many cameras it has, etc. We&rsquo;ve done the basic work for you and put together a starting set of configuration files that will describe your Lumen. If you&rsquo;d like to use the defaults to start with, then follow the instructions below to place them where OpenPnP can use them.</p><p>If you&rsquo;d like to start from scratch with your setup, community member Qwertymodo has posted a <a href="https://www.youtube.com/watch?v=vuFalyzcCZA">very helpful video</a> showing his process of doing calibration on his machine from scratch. It&rsquo;s a great place to start if you want to do all the setup yourself.</p><h2 id=windows>Windows</h2><ol><li><p>Download OpenPnP 2.0 for Windows <a href=https://openpnp.org/downloads/>here</a> (probably the 64 bit installer).</p></li><li><p>Go to the <a href=https://github.com/opulo-inc/lumenpnp/releases>LumenPnP Releases Page</a>.</p></li><li><p>Find the latest release that is compatible with your hardware. If your machine&rsquo;s version begins with <code>v2</code>, pick the most recent release starting with <code>v2</code>. If your machine&rsquo;s version begins with <code>v3</code>, pick the most recent release starting with <code>v3</code>.</p></li><li><p>Download the <code>Source Code (zip)</code> for that release.</p></li><li><p>Unzip the source code.</p></li><li><p>Navigate to the <code>openPnP</code> folder inside and find the three configuration files you need: <code>machine.xml</code>, <code>packages.xml</code>, and <code>parts.xml</code>.</p></li><li><p>To install these files in OpenPnP, you&rsquo;ll need to find its configuration folder. First, follow <a href=https://support.microsoft.com/en-us/windows/show-hidden-files-0320fe58-0117-fd59-6851-9b7f9840fdb2>these instructions</a> to show hidden folders in Windows Explorer.</p></li><li><p>Next, navigate to:</p><ol><li>On Windows Vista and above: <code>C:\Users\[username]\.openpnp2</code>.</li><li>On Windows 2000, XP and 2003: <code>C:\Documents and Settings\[username]\.openpnp2</code>.</li></ol></li><li><p>Double-check that OpenPnP is closed</p></li><li><p>In the <code>.openpnp2</code> folder you&rsquo;ll find the currently used configuration files, <code>machine.xml</code>, <code>packages.xml</code>, and <code>parts.xml</code>. It is a good idea to copy these somewhere as backup whenever you make changes like this.</p></li><li><p>Copy the configuration files from the LumenPnP source files into <code>.openpnp2</code> and overwrite the old configuration files. Note that if you&rsquo;ve already been using OpenPnP, you may want to only replace your <code>machine.xml</code> file, as the other files will overwrite your existing components library.</p></li></ol><h2 id=macos>MacOS</h2><ol><li><p>Download OpenPnP 2.0 for Mac <a href=https://openpnp.org/downloads/>here</a>.</p></li><li><p>Go to the <a href=https://github.com/opulo-inc/lumenpnp/releases>LumenPnP Releases Page</a>.</p></li><li><p>Find the latest release that is compatible with your hardware. If your machine&rsquo;s version begins with <code>v2</code>, pick the most recent release starting with <code>v2</code>. If your machine&rsquo;s version begins with <code>v3</code>, pick the most recent release starting with <code>v3</code>.</p></li><li><p>Download the <code>Source Code (zip)</code> for that release.</p></li><li><p>Unzip the source code.</p></li><li><p>Navigate to the <code>openPnP</code> folder inside and find the three configuration files you need: <code>machine.xml</code>, <code>packages.xml</code>, and <code>parts.xml</code>.</p></li><li><p>To install these files in OpenPnP, you&rsquo;ll need to find its configuration folder. Note you may need to follow <a href=https://www.macworld.com/article/671158/how-to-show-hidden-files-on-a-mac.html>these instructions</a> to show hidden folders in Finder.</p></li><li><p>Next, navigate to: <code>/Users/[username]/.openpnp2</code>.</p></li><li><p>Double check that OpenPnP is closed.</p></li><li><p>In the <code>.openpnp2</code> folder you&rsquo;ll find the currently used configuration files, <code>machine.xml</code>, <code>packages.xml</code>, and <code>parts.xml</code>. It is a good idea to copy these somewhere as backup whenever you make changes like this.</p></li><li><p>Copy the configuration files from the LumenPnP source files into <code>.openpnp2</code> and overwrite the old configuration files. Note that if you&rsquo;ve already been using OpenPnP, you may want to only replace your <code>machine.xml</code> file, as the other files will overwrite your existing components library.</p></li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-9aa5243beec8d65dee67c05faf8bfc04>2 - Connecting to Your Machine</h1><div class=lead>Getting set up and connected to your LumenPnP using OpenPnP</div><p>Awesome! Now we&rsquo;ve got OpenPnP installed on your computer, and we&rsquo;ve got the default configuration loaded up, our next step is getting connected to the machine using OpenPnP and getting familiar with the UI.</p><ol><li>Connect your machine to your computer using the included USB cable, and open OpenPnP on your computer. You should now see the OpenPnP UI:</li></ol><figure><img src=https://docs.opulo.io/openpnp/calibration/connect-to-machine/images/openpnp-ui_hu55d59ea4a896c01130dd25c1de56472a_1304284_800x600_fit_catmullrom_2.png alt></figure><h2 id=com-port-and-baud-rate>Com Port and Baud Rate</h2><p>Before connecting to the machine, you need to set which USB ports to use for communication in OpenPnP.</p><ol><li><p>Click on the <code>Machine Setup</code> tab<figure><img src=https://docs.opulo.io/openpnp/calibration/connect-to-machine/images/Machine-Setup-Tab_hu9becbda77ddecaeccc8b522f7a08fc57_149296_800x600_fit_catmullrom_2.png alt="Selecting the Machine setup tab from the main screen"></figure></p></li><li><p>Click on the &ldquo;Expand&rdquo; checkbox to open all of the features about your machine.<figure><img src=https://docs.opulo.io/openpnp/calibration/connect-to-machine/images/Expand-Checkbox_huf038785efff1acdfda3bdd293aeb869c_201594_800x600_fit_catmullrom_2.png alt="Expanding the Machine Config options"></figure></p></li><li><p>Under <code>Drivers</code> click on <code>GcodeDriver GcodeDriver</code><figure><img src=https://docs.opulo.io/openpnp/calibration/connect-to-machine/images/SelectGcodeDriver_huf3901eb0e2fa754ae4e955dba43cc1e8_217447_800x600_fit_catmullrom_2.png alt="Reviewing the GcodeDriver options"></figure></p></li><li><p>Below the list of machine settings you&rsquo;ll find the details of the GcodeDriver. In the <code>Configuration</code> tab, check the <code>Baud</code> and <code>Port</code> settings.</p><ol><li>The <code>Baud</code> should be <code>115200</code></li><li>On Windows, the <code>Port</code> should be in the format: <code>COM2</code>.</li><li>On Mac, the <code>Port</code> should be in the format: <code>cu.usbmodem&lt;a-lot-of-numbers></code></li><li>On Linux, the <code>Port</code> should be in the format: <code>ttyACM0</code>.<figure><img src=https://docs.opulo.io/openpnp/calibration/connect-to-machine/images/Check%20COM%20Port%20and%20Baud%20Rate_hu685c79480ba56916b3d4f0d0d4b7cd5b_209704_800x600_fit_catmullrom_2.png alt="Changing the Port and Baud Rate"></figure></li></ol></li></ol><div class="alert alert-info" role=alert><h4 class=alert-heading>Port Not Found</h4>If your machine&rsquo;s port does not show up in the drop down, check that it is plugged in to both your computer and the LumenPnP, and that the motherboard is powered on. If you still cannot find the port, try pressing the reset button on the motherboard and closing and reopening OpenPnP.</div><h2 id=bottom-camera-config>Bottom Camera Config</h2><p>Now we&rsquo;ll set up the cameras. The big red &ldquo;X&rdquo; in the camera views means that OpenPnP doesn&rsquo;t know where to find the webcam feed. OpenPnP needs to know which webcam is which.</p><div class="alert alert-warning" role=alert><h4 class=alert-heading>Camera Connection Issues (v2 Hardware)</h4>The LumenPnP motherboard in <code>v2</code> machines have a built in USB hub and USB ports for you to plug the two webcams into. This arrangement may not be compatible with your computer. Some computers use higher quality USB hubs, which can handle the bandwidth required to stream video from both webcams at once over a single USB port. From reports we&rsquo;ve gotten from users, it seems that <em>many</em> computer manufactures do <strong>not</strong> include good enough USB hubs. In these cases, one or both of the USB webcams will fail to show up in the configuration list below. If this is the case, you will need to plug at least one of the webcams directly into your computer via a separate USB port. Occasionally this can cause the webcam&rsquo;s name to be incorrect, but you&rsquo;ll still be able to select it from the drop-down list by connecting and reconnecting the camera.</div><ol><li><p>Again, navigate to the <code>Machine Setup</code> tab</p></li><li><p>Again, click the &ldquo;Expand&rdquo; checkbox if necessary</p></li><li><p>Under <code>Cameras</code> click on <code>OpenPnpCaptureCamera Bottom</code><figure><img src=https://docs.opulo.io/openpnp/calibration/connect-to-machine/images/Bottom%20Camera%20Config_huc03da266f381e376fc014d520895829c_212641_800x600_fit_catmullrom_2.png alt="Finding the Bottom Camera Settings"></figure></p></li><li><p>In the lower detail pane, switch to the <code>Device Settings</code> tab<figure><img src=https://docs.opulo.io/openpnp/calibration/connect-to-machine/images/Bottom-camera-device-settings_hu5d92b1a21f9045925a93aae89d3faff8_230542_800x600_fit_catmullrom_2.png alt="Switching to the camera device settings"></figure></p></li><li><p>In the <code>Device</code> drop-down, choose <code>PnP Bottom Camera (PnP Bottom Camera)</code><figure><img src=https://docs.opulo.io/openpnp/calibration/connect-to-machine/images/Bottom-camera-select-device_hu5d92b1a21f9045925a93aae89d3faff8_229497_800x600_fit_catmullrom_2.png alt="Selecting the correct device for the Bottom Camera"></figure></p></li><li><p>In the <code>Format</code> drop-down, choose the <code>1280x720 10fps</code> setting</p></li><li><p>Click the &ldquo;Apply&rdquo; button in the bottom right<figure><img src=https://docs.opulo.io/openpnp/calibration/connect-to-machine/images/Bottom%20Camera%20Apply_hu060439fdc85e00b619ad0df767e90368_229204_800x600_fit_catmullrom_2.png alt="Saving changes to the Bottom Camera Config"></figure></p></li></ol><h2 id=top-camera-config>Top Camera Config</h2><ol start=13><li><p>Again, navigate to the <code>Machine Setup</code> tab</p></li><li><p>Again, click the &ldquo;Expand&rdquo; checkbox if necessary</p></li><li><p>Navigate to <code>Heads > ReferenceHead H1 > Cameras > OpenPnPCaptureCamera Top</code><figure><img src=https://docs.opulo.io/openpnp/calibration/connect-to-machine/images/Top-camera-settings_hu682374ddcdf571115ab1e5870eb9e672_218156_800x600_fit_catmullrom_2.png alt="Finding the Top Camera Settings"></figure></p></li><li><p>In the lower detail pane, switch to the <code>Device Settings</code> tab<figure><img src=https://docs.opulo.io/openpnp/calibration/connect-to-machine/images/Top-camera-device-settings_hu54265124499489fd2a5b32b5fd562263_229215_800x600_fit_catmullrom_2.png alt="Switching to the camera device settings"></figure></p></li><li><p>In the <code>Device</code> drop-down, choose <code>PnP Bottom Camera (PnP Top Camera)</code><figure><img src=https://docs.opulo.io/openpnp/calibration/connect-to-machine/images/Bottom-camera-select-device_hu5d92b1a21f9045925a93aae89d3faff8_229497_800x600_fit_catmullrom_2.png alt="Selecting the correct device for the Bottom Camera"></figure></p></li><li><p>In the <code>Format</code> drop-down, choose the <code>1280x720 10fps</code> setting</p></li><li><p>Click the &ldquo;Apply&rdquo; button in the bottom right<figure><img src=https://docs.opulo.io/openpnp/calibration/connect-to-machine/images/Top%20Camera%20Apply_hu044a2da3c4e98c8f65bd67db7465591c_229586_800x600_fit_catmullrom_2.png alt="Saving changes to the Top Camera Config"></figure></p></li><li><p>To check that both cameras are working now, select your preferred view option in the top left <code>Cameras</code> section. The Camera feeds should update automatically. If you only see a black image but the red <code>X</code> has disappeared, it&rsquo;s likely that your camera is connected properly, but just has its exposure set too low. We&rsquo;ll address this in a later step.<figure><img src=https://docs.opulo.io/openpnp/calibration/connect-to-machine/images/Both-cameras-working_hu27ddd70355879baa918dc5969dd00a70_383789_800x600_fit_catmullrom_2.png alt="Both cameras showing live outputs."></figure></p></li></ol><h2 id=connecting-to-the-lumenpnp>Connecting to the LumenPnP</h2><ol start=21><li><p>Click the green power button in the Machine Controls section of the UI to connect to your machine.<figure><img src=https://docs.opulo.io/openpnp/calibration/connect-to-machine/images/Screen%20Shot%202022-05-17%20at%204.14.47%20PM_huebbe6adbe0ce9256c4cc259700e55824_87090_800x600_fit_catmullrom_2.png alt></figure></p></li><li><p>The power button should turn red, and OpenPnP has connected to your machine. You should also see both webcam feeds as shown below. (If you don&rsquo;t see any, or just one, under the <code>Cameras</code> section, select the <code>Show All Horizontal</code> option from the dropdown.)<figure><img src=https://docs.opulo.io/openpnp/calibration/connect-to-machine/images/Screen%20Shot%202022-05-17%20at%204.16.20%20PM_hu86ead4822337e327c457ec9747ce8d9b_1889301_800x600_fit_catmullrom_2.png alt></figure></p></li><li><p>Save your OpenPnP settings with <code>File > Save Configuration</code>.</p></li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-aaf9170e03c8b8784391d0b712f079b1>3 - Camera Fisheye Calibration</h1><div class=lead>Applying fisheye calibration to the cameras</div><p>Now that you&rsquo;re connected to the LumenPnP, you&rsquo;ll need to set up the cameras so that they can accurately fine tune the machine&rsquo;s position. The LumenPnP is a robust machine, but it needs both cameras to make sure it can pick and place components reliably every time. Note that these are very important calibration steps, but OpenPnP makes them relatively easy. Certain steps will probably need you to tune them more than once to get them perfect, others should stay mostly constant.</p><p>The first step is to correct for the fisheye effect of the webcams to help make sure they can identify distances accurately. This is not a step you will need to re-run unless you replace your webcams or lenses. <a href=https://github.com/openpnp/openpnp/wiki/Camera-Lens-Calibration>Original OpenPnP documentation for reference</a>.</p><h2 id=top-camera-calibration>Top Camera Calibration</h2><ol><li><p>Click on the <code>Machine Setup</code> tab.<figure><img src=https://docs.opulo.io/openpnp/calibration/camera-fisheye-cal/images/Machine-Setup-Tab_hu9becbda77ddecaeccc8b522f7a08fc57_149296_800x600_fit_catmullrom_2.png alt="Selecting the Machine setup tab from the main screen"></figure></p></li><li><p>Click on the &ldquo;Expand&rdquo; checkbox to open all of the features about your machine.<figure><img src=https://docs.opulo.io/openpnp/calibration/camera-fisheye-cal/images/Expand-Checkbox_huf038785efff1acdfda3bdd293aeb869c_201594_800x600_fit_catmullrom_2.png alt="Expanding the Machine Config options"></figure></p></li><li><p>Under <code>Cameras</code> click on <code>OpenPnpCaptureCamera Top</code></p></li></ol><figure><img src=https://docs.opulo.io/openpnp/calibration/camera-fisheye-cal/images/Top-camera-settings_hu682374ddcdf571115ab1e5870eb9e672_218156_800x600_fit_catmullrom_2.png alt="Finding the Top Camera Settings"></figure><ol start=5><li>In the lower detail pane, switch to the <code>Lens Calibration</code> tab<figure><img src=https://docs.opulo.io/openpnp/calibration/camera-fisheye-cal/images/Bottom-camera-lens-calibration-tab_hu63ce86602a49c6a5547f8249c9a5f50f_397809_800x600_fit_catmullrom_2.png alt="Switching to the lens calibration tab"></figure></li></ol><div class="alert alert-info" role=alert><h4 class=alert-heading>Tip</h4>To see both camera views at the same time, click on the dropdown in the top left of the UI and select &ldquo;Show All Horizontal&rdquo;.</div><ol start=6><li><p>Click <code>Start Lens Calibration</code>.<figure><img src=https://docs.opulo.io/openpnp/calibration/camera-fisheye-cal/images/Bottom-camera-click-lens-calibration_hu5974ba7c22d94d5c9b83c13f4d3ff512_399211_800x600_fit_catmullrom_2.png alt="Starting bottom camera lens calibration"></figure></p></li><li><p>OpenPnP is now looking for a specific pattern of dots. If you have a <code>v2</code> machine, you can find this pattern is on the back side of your datum board. If you have a <code>v3</code> machine, you can find this pattern on the back side of the FTP board in your Getting Started Kit.</p></li><li><p>Hold the pattern under the top camera as shown below. Check the camera view in OpenPnP to move the pattern into focus. If the focal distance is too close such that you can&rsquo;t get the whole pattern in focus and in the field of view, screw in the lens a few turns and test again. If you&rsquo;re having trouble adjusting the focus, try using the community-created <a href=https://www.printables.com/model/208453-lumen-pnp-lens-adjustment-tool>lens adjustment tool</a>.</p></li><li><p>OpenPnP will flash when it takes an image of the pattern, and will require you to take a few for an accurate calibration. Slowly move the calibration pattern around the camera&rsquo;s field of view until OpenPnP tells you that it&rsquo;s gathered enough photos.</p></li></ol><p><figure><img src=https://docs.opulo.io/openpnp/calibration/camera-fisheye-cal/images/PXL_20220519_165145418_hu15b03473077026be66c973a033b5eb33_1792545_800x600_fit_q75_catmullrom.jpg alt></figure><figure><img src=https://docs.opulo.io/openpnp/calibration/camera-fisheye-cal/images/Screen%20Shot%202022-05-19%20at%2012.53.30%20PM_hudf618c3cddf4e4d0e96d42784c1d2eb8_1412605_800x600_fit_catmullrom_2.png alt></figure></p><div class="alert alert-info" role=alert><h4 class=alert-heading>Tip</h4>If you&rsquo;re having a hard time getting the camera to pick up on the pattern on the datum board or FTP board, you can always print out the original calibration pattern recommended by OpenPnP, which you can find <a href=https://nerian.com/support/calibration-patterns/>here</a>. Be sure to download the &ldquo;Circle Grid Camera Calibration Patterns&rdquo; image.</div><ol start=11><li>Confirm that the <code>Apply Calibration?</code> checkbox is enabled checked after calibration is complete.<figure><img src=https://docs.opulo.io/openpnp/calibration/camera-fisheye-cal/images/Screen%20Shot%202022-05-19%20at%2012.49.28%20PM_hub4ab823f64c2dab0702372cb5ab2b96f_142433_800x600_fit_catmullrom_2.png alt></figure></li></ol><h2 id=bottom-camera-calibration>Bottom Camera Calibration</h2><ol start=13><li><p>Again, navigate to the <code>Machine Setup</code> tab</p></li><li><p>Again, click the &ldquo;Expand&rdquo; checkbox if necessary</p></li><li><p>Navigate to <code>Heads > ReferenceHead H1 > Cameras > OpenPnPCaptureCamera Bottom</code><figure><img src=https://docs.opulo.io/openpnp/calibration/camera-fisheye-cal/images/Bottom%20Camera%20Config_huc03da266f381e376fc014d520895829c_212641_800x600_fit_catmullrom_2.png alt="Finding the Bottom Camera Settings"></figure></p></li><li><p>Continue with the same steps starting from number 5 above for the bottom camera.</p></li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-bf04f0f3afaabb8259c1b63c7a4b487a>4 - Homing Fiducial</h1><div class=lead>Setting up the datum board and testing the homing fiducial</div><p>Now that fisheye calibration is complete, we can set up the datum board. The datum board is a reference point for everything else you&rsquo;ll do with the machine. The center dot of the datum board will be the most important calibration point for the machine. It&rsquo;ll be used to fine-tune the LumenPnP&rsquo;s XY position after homing to account for any errors in the limit switches.</p><div class="alert alert-warning" role=alert><h4 class=alert-heading>If Your Machine Is v2</h4><p>If you are setting up a <code>v2</code> machine, your datum board is not yet mounted to the Staging Plate.</p><p>Use four M3x16mm screws and four M3 nuts to secure the datum board and datum board mount to the staging plate on the rear of the bottom camera, through holes: B18, A19, A21, B22. The the fisheye calibration pattern should be facing down, and the gold grid of lines and fiducial in the center of the Opulo logo facing upwards. Tighten this down securely.</p><figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Screen%20Shot%202022-01-11%20at%2012.51.47%20PM_hu3871e0f1e06af5e9f4bfd668c8376cd1_705927_800x600_fit_catmullrom_2.png alt="the mounting location for the datum board and holder"></figure></div><ol><li>In the &ldquo;Machine Controls&rdquo; pane in the lower left, connect to the LumenPnP if you haven&rsquo;t already by pressing the power button.</li><li>Run a rough home routine by pressing the Home button (shaped like a house). The machine will move to the X, Y, and Z zero positions. The default machine configuration files are set so that OpenPnP will <em>not</em> try to use the homing fiducial yet. Note that the home icon will turn yellow, as the LumenPnP has homed to it&rsquo;s end stops, but hasn&rsquo;t completed its full homing routine.<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Connect-and-home_hu878b8b02b21cf6aad7217e2cce3f6c33_399285_800x600_fit_catmullrom_2.png alt="Connect to the LumenPnP and attempt to home it"></figure></li></ol><h2 id=tuning-the-homing-fiducial>Tuning the Homing Fiducial</h2><ol start=3><li><p>Click on the <code>Machine Setup</code> tab in the top right pane.<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Machine-Setup-Tab_hu9becbda77ddecaeccc8b522f7a08fc57_149296_800x600_fit_catmullrom_2.png alt="Selecting the Machine setup tab from the main screen"></figure></p></li><li><p>Click on the &ldquo;Expand&rdquo; checkbox to open all of the features about your machine.<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Expand-Checkbox_huf038785efff1acdfda3bdd293aeb869c_201594_800x600_fit_catmullrom_2.png alt="Expanding the Machine Config options"></figure></p></li><li><p>Under <code>Heads</code>, click on <code>ReferenceHead H1</code><figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Select-Reference-Head-H1_huf636f77a2d551124ea71699849172ab4_400566_800x600_fit_catmullrom_2.png alt="Reviewing the ReferenceHead options"></figure></p></li><li><p>In the bottom right details pane, you&rsquo;ll be looking at the <code>Configuration</code> Tab. Change the <code>Homing Method</code> to <code>ResetToFiducialLocation</code>. This will set OpenPnP to use the top camera to look for the homing fiducial to more precisely home the XY gantry, instead of only using the limit switches.<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Select-ResetToFiducialLocation_huc542783d5e9b9613c20616f2f867f8f3_398619_800x600_fit_catmullrom_2.png alt="Switch to using the homing fiducial"></figure></p></li><li><p>Click <code>Apply</code> to save this change.<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Homing-fiducial-apply_hu4849e2d96494b4ec930a4595a4a2c504_403085_800x600_fit_catmullrom_2.png alt="Save the homing technique"></figure></p></li><li><p>Click on the &ldquo;Position Camera over location&rdquo; icon button show below. This will move the top camera to approximately where your datum board is mounted.<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Position-camera-over-homing-fiducial_huf3fa0cd51c56180c162bad6a3da8b092_407721_800x600_fit_catmullrom_2.png alt="Position top camera over homing fiducial"></figure></p></li><li><p>In the bottom left Machine Controls pane, Select the <code>Actuators</code> tab.<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Actuators-tab_hu34ccfcb97d74441c6b8019e501efeb16_403495_800x600_fit_catmullrom_2.png alt="Switch to the Actuators Tab"></figure></p></li><li><p>Toggle on the LED ring lights by pressing the <code>LED</code> button.<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Turn-on-LEDs_hu37f630a3310747b62d2bdf6189df9425_406578_800x600_fit_catmullrom_2.png alt="Turn on the LEDs"></figure></p></li><li><p>If the fiducial board is not in focus, rotate the Top Camera lens until the board is sharply in focus.<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/In-focus-homing-fiducial_hu436b1a4759aeace3aad4d6f5c86dcdbe_446368_800x600_fit_catmullrom_2.png alt="Turn on the LEDs"></figure></p></li></ol><div class="alert alert-info" role=alert><h4 class=alert-heading>Tip</h4><p>Right click on the camera feed to change the Reticle style to see the center of the camera image. You can also use the scroll wheel to zoom in on the feed for more precision.</p><figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Switch-reticle-type_hu3e0ac36ce14c9c1865147ab4266b6c31_423249_800x600_fit_catmullrom_2.png alt="Change the reticle that appears on the camera feed"></figure></div><ol start=13><li>Go back to the <code>Jog</code> tab in the &ldquo;Machine Controls&rdquo; pane.<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Jog-tab_huee90190c5b366dc783f1df2b7e6d605b_478092_800x600_fit_catmullrom_2.png alt="Switch to the jog tab"></figure></li><li>Set the <code>Distance</code> slider to <code>0.1</code> for more precise movements.<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Distance-slider-0pt1_hu1e2e515ad763ef6cbf5801f652141684_482204_800x600_fit_catmullrom_2.png alt="Make the jog controls more precise"></figure></li><li>Manually jog the head so that the reticle in the center of the Top Camera feed in your top camera view is perfectly centered on the Homing Fiducial in the center of the Opulo logo.<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Homing-fiducial-centered_hu0d7284a2e039c67e818fea0f39c64158_504968_800x600_fit_catmullrom_2.png alt="Center the homing fiducial in the camera view"></figure></li></ol><h2 id=check-camera-exposure>Check Camera Exposure</h2><p>Set the exposure for the top camera so that we&rsquo;re seeing the homing fiducial clearly and sharply.</p><ol start=16><li><p>Navigate to the <code>Machine Setup</code> tab<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Machine-Setup-Tab_hu9becbda77ddecaeccc8b522f7a08fc57_149296_800x600_fit_catmullrom_2.png alt="Selecting the Machine setup tab from the main screen"></figure></p></li><li><p>Click the &ldquo;Expand&rdquo; checkbox if necessary<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Expand-Checkbox_huf038785efff1acdfda3bdd293aeb869c_201594_800x600_fit_catmullrom_2.png alt="Expanding the Machine Config options"></figure></p></li><li><p>Navigate to <code>Heads > ReferenceHead H1 > Cameras > OpenPnPCaptureCamera Top</code><figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Top-camera-settings_hu682374ddcdf571115ab1e5870eb9e672_218156_800x600_fit_catmullrom_2.png alt="Finding the Top Camera Settings"></figure></p></li><li><p>In the lower detail pane, switch to the <code>Device Settings</code> tab<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Top-camera-device-settings_hu54265124499489fd2a5b32b5fd562263_229215_800x600_fit_catmullrom_2.png alt="Switching to the camera device settings"></figure></p></li><li><p>Scroll down if necessary to the <code>Properties</code> list of adjustments for the camera image.<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Top-camera-properties_hu1a205294ef83ec2281157e6da3eef155_386438_800x600_fit_catmullrom_2.png alt="Top camera properties"></figure></p></li><li><p>The goal here is to make the center fiducial look bright and sharp, and have the surrounding soldermask look dark. In most cases you can simply check the <code>Auto</code> checkbox for <code>Exposure</code>, then uncheck it to save the automatically set value, and this does a good job of making the image look how you want. Note that this may not work in all situations, so you may need to manually adjust the image settings to get a clear image, where the Homing Fiducial is clearly distinguished against the background of the datum board.<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Auto-exposure-on_hue6840cb5d3b433e112436e5a4e79a15b_438989_800x600_fit_catmullrom_2.png alt="Top camera properly exposed with the auto-exposure turned on"></figure></p></li></ol><div class="alert alert-danger" role=alert><h4 class=alert-heading>For Mac Users</h4>Due to an issue with the camera driver in OpenPnP, some Mac users might notice that the image settings are greyed out for you. There&rsquo;s a fantastic open-source application called <a href=https://github.com/Itaybre/CameraController>CameraController</a> that can be used to edit these settings!</div><h2 id=apply-homing-fiducial-changes>Apply Homing Fiducial Changes</h2><ol start=19><li><p>Double-check that:</p><ol><li>The Homing Fiducial is in the center of the reticle in the camera feed</li><li>The camera image is in sharp focus</li><li>The camera image is properly exposed</li></ol></li><li><p>Go back to Machine Setup and select <code>Heads > ReferenceHead H1</code>.<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Select-Reference-Head-H1_huf636f77a2d551124ea71699849172ab4_400566_800x600_fit_catmullrom_2.png alt="Return to the homing fiducial location settings"></figure></p></li><li><p>Click on the &ldquo;Capture Location&rdquo; icon button to save the location where OpenPnP will start searching for the Homing Fiducial.<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Capture-homing-fiducial-location_hud6884041bd256ea6d66c91423452843d_519972_800x600_fit_catmullrom_2.png alt="Capture the location of the homing fiducial"></figure></p></li><li><p>Click <code>Apply</code> to save your changes.<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Homing-fiducial-apply_hu4849e2d96494b4ec930a4595a4a2c504_403085_800x600_fit_catmullrom_2.png alt="Save homing fiducial location"></figure></p></li><li><p>Click on the &ldquo;Home&rdquo; button in the <code>Machine Controls Pane > Jog Tab</code> and watch your machine home using the limit switches, then move the top camera over the homing fiducial and find its exact location.</p></li></ol><h2 id=troubleshooting-vision-pipeline-adjustment>Troubleshooting: Vision Pipeline Adjustment</h2><ol start=24><li><p>If you find that the machine is having a hard time finding the homing fiducial, you might need to edit the Vision Pipeline for it. You can do that by going to the <code>Machine Setup</code> tab, and selecting <code>Fiducial Locator</code> under <code>Vision</code>. Click the <code>Edit</code> button to adjust the computer vision settings.<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Screen%20Shot%202022-05-18%20at%202.22.00%20PM_hu9a071cd0e1adf4944c035e71f0b4f929_109764_800x600_fit_catmullrom_2.png alt></figure></p></li><li><p>There is quite a bit to tuning a vision pipeline, and you should take a look at the <a href=https://github.com/openpnp/openpnp/wiki/Bottom-Vision>OpenPnP documentation</a>. But there are a few things you can pretty easily tweak to get up and running. First, let&rsquo;s check out what the vision pipeline <em>thinks</em> it&rsquo;s seeing. In the window that just popped up, click on the row with &ldquo;DrawCircles&rdquo; in the Stage column. The image will show you every circle detected from the pipeline, as shown below. If there is more than one, or if the one shown is not perfectly hugging the fiducial, there are tweaks to be made. The image below shows a correctly tuned pipeline, with a single circle encircling the fiducial.</p></li></ol><figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Screen%20Shot%202022-05-18%20at%202.41.29%20PM_hu1df961fb245c11c20917b35e50176843_2682214_800x600_fit_catmullrom_2.png alt></figure><ol start=11><li>The first variable to address is the threshold value. To access these settings, click on the row with &ldquo;Threshold&rdquo; under the Stage column. If the threshold is too low, then we won&rsquo;t be isolating the area around the fiducial enough. A too low of a threshold value will look like the image below:</li></ol><figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Screen%20Shot%202022-05-18%20at%202.25.13%20PM_hufa159e9e91836849043931444e5b6511_291035_800x600_fit_catmullrom_2.png alt></figure><p>Raise the value until the fiducial is a clean, solid circle, as shown below:</p><figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Screen%20Shot%202022-05-18%20at%202.25.59%20PM_hud6b60e82215d5cc6b1a3e7a85f250d0d_284448_800x600_fit_catmullrom_2.png alt></figure><ol start=11><li>Next, we can check and see how many circles the pipeline is finding. We want it to only be finding one, and have it hug the fiducial exactly. Click on the row with &ldquo;DetectCirclesHough&rdquo; in the Stage column. In the image below, you can see from the list in the bottom right that two circles have been detected. We can solve this by adjusting &ldquo;param2&rdquo; and bumping the value up. The lower the value, the more circles are detected. If the diameter of the circles detected is incorrect, adjust the maxDiameter and minDiameter settings.</li></ol><figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Screen%20Shot%202022-05-18%20at%202.26.48%20PM_hud6b60e82215d5cc6b1a3e7a85f250d0d_302476_800x600_fit_catmullrom_2.png alt></figure><p>With a higher value in the &ldquo;param2&rdquo; field, we only detect a single circle.</p><figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Screen%20Shot%202022-05-18%20at%202.27.08%20PM_hue434d16e9230f350073847ad19ffcabe_276517_800x600_fit_catmullrom_2.png alt></figure><ol start=12><li>Lastly, you can confirm that the changes result in accurate fiducial detection. Once again click on the row with &ldquo;DrawCircles&rdquo; in the Stage column. The image will show you every circle detected from the pipeline. Confirm there is only one, and it is perfectly hugging the fiducial as shown below.</li></ol><figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Screen%20Shot%202022-05-18%20at%202.41.29%20PM_hu1df961fb245c11c20917b35e50176843_2682214_800x600_fit_catmullrom_2.png alt></figure><ol start=13><li><p>Exit out of the pipeline editing UI, save your changes, and try to home again. With your vision pipeline tuned, the machine should find the homing fiducial on your machine and center the crosshairs of the top camera on it.</p></li><li><p>It is likely that the machine will move to the wrong place and not be able to identify the homing fiducial. If this happens, OpenPnP will give an error popup that says <code>FIDUCIAL-HOME no matches found</code>. This is normal, as it means you&rsquo;ll need to fine-tune the location that OpenPnP moves the LumenPnP to in order to find the homing fiducial. You&rsquo;ll also note that the home icon will turn yellow, as the LumenPnP has homed to the end stops, but hasn&rsquo;t completed the full homing routine.<figure><img src=https://docs.opulo.io/openpnp/calibration/homing-fiducial/images/Cant-find-homing-fiducial_hu360a7de5d65a620e45f97581a1ebd17c_397783_800x600_fit_catmullrom_2.png alt="A first attempt at homing the LumenPnP"></figure></p></li></ol><div class="alert alert-info" role=alert><h4 class=alert-heading>Note</h4>Once your machine succeeds in finding the homing fiducial, the homing procedure will continue, and will try to detect a nozzle on your toolhead. This will fail, and you will receive the error: <code>Nozzle tip calibration: too many vision misdetects. Check pipeline and threshold.</code> This is expected, and if you see this you can move onto <a href=/openpnp/calibration/mm-per-pixel/>MM/Pixel calibration</a>.</div></div><div class=td-content style=page-break-before:always><h1 id=pg-358773e9a017901b2175f788046eb4f3>5 - MM/pixel Calibration</h1><div class=lead>Setting the millimeters per pixel value in OpenPnP</div><p>Nicely done so far! You&rsquo;ve got your homing fiducial all set up, and have played around with tweaking a vision pipeline. This next step calibrates the relationship between pixels and millimeters to make our cameras more accurate.</p><ol><li><p>First, let&rsquo;s calibrate the top camera. Jog the camera over to your datum board. Select your machine&rsquo;s head in the <code>Machine Setup</code> tab, and click the icon highlighted below to move there. There are some markers on the datum board that will help us do this exact calibration.<figure><img src=https://docs.opulo.io/openpnp/calibration/mm-per-pixel/images/Screen%20Shot%202022-05-17%20at%204.27.00%20PM_hu7a12b82d972ce5704cf4cc36d6845b39_837888_800x600_fit_catmullrom_2.png alt></figure></p></li><li><p>Select your top camera in the device tree. Under the <code>General Configuration</code> tab, scroll down to <code>Units Per Pixel</code>. Under the X and Y Object Dimensions, type in the number 5.<figure><img src=https://docs.opulo.io/openpnp/calibration/mm-per-pixel/images/Screen%20Shot%202022-05-19%20at%2012.25.50%20PM_hubb955fe34e8589149b057a0613b31c92_185186_800x600_fit_catmullrom_2.png alt></figure></p></li><li><p>Now, zoom out on the camera and jog to one of the golden squares on the datum board. Make sure the entire square is visible in the camera&rsquo;s field of view like the image below.</p></li></ol><figure><img src=https://docs.opulo.io/openpnp/calibration/mm-per-pixel/images/Screen%20Shot%202022-05-19%20at%2012.28.42%20PM_hub1022bfc9771aad88d43a1d89ed95b54_638111_800x600_fit_catmullrom_2.png alt></figure><ol start=4><li>Then click the <code>Measure</code> button. A box with drag handles will appear in the camera viewfinder. Drag the box so that it lines up with the golden box on the datum board; they are exactly 5mm x 5mm. Make sure that you are aligning the bounding box with the <strong>center</strong> of the golden lines as shown in the image below. Once you have it perfectly outlined, click <code>Confirm</code>. New numbers should populate the Units per Pixel fields, but they should be relatively close to what you found in there to begin with. Then hit <code>Apply</code>.</li></ol><figure><img src=https://docs.opulo.io/openpnp/calibration/mm-per-pixel/images/Screen%20Shot%202022-05-19%20at%2012.30.48%20PM_hub3185a73c44b5f1b9b9f4388ef14b8eb_511023_800x600_fit_catmullrom_2.png alt></figure><ol start=5><li><p>To confirm, jog around by clicking on various locations on your datum board in the top camera viewfinder and see how accurate the centerpoint of the camera view gets to where you clicked. If it&rsquo;s inaccurate, try doing the calibration again or tweaking the values in the fields.</p></li><li><p>Now we&rsquo;ll calibrate the bottom camera. For this, we&rsquo;ll use a nozzle tip! Put an N24 nozzle on the CP40 Holder, and under your bottom camera&rsquo;s settings in the device tree, under the <code>Position</code> tab, click the icon with the red nozzle in the blue circle (Hover text says &ldquo;Position the tool over the center of the location&rdquo;). This should move your nozzle over the camera. Don&rsquo;t worry if it&rsquo;s not exactly centered; we&rsquo;ll fix this in a later step. It&rsquo;s important you don&rsquo;t try to fix this now. Manually jog it over the center of your bottom camera by clicking on the bottom camera viewfinder. If your lens is not focused on the nozzle tip, you should rotate the lens so that the nozzle tip is sharp and clear.</p></li></ol><figure><img src=https://docs.opulo.io/openpnp/calibration/mm-per-pixel/images/Screen%20Shot%202022-05-19%20at%2012.38.59%20PM_hu9318e1afcf613a3be50be9092761a26c_123099_800x600_fit_catmullrom_2.png alt></figure><ol start=7><li>Now, do the same calibration that you did for the top camera, but instead of inputting 5 in the X and Y fields, input 4. Drag your bounding box around the nozzle tip so that it&rsquo;s perfectly tangent to the edges, and press <code>Confirm</code>. Your pixels per millimeter are now calibrated! Try clicking around the bottom viewfinder and check to see if the reticle is moving where you click.</li></ol><figure><img src=https://docs.opulo.io/openpnp/calibration/mm-per-pixel/images/Screen%20Shot%202022-05-19%20at%2012.41.42%20PM_hu6ecf2adb8fd510320d8fe0ddcd3f3c14_1260848_800x600_fit_catmullrom_2.png alt></figure></div><div class=td-content style=page-break-before:always><h1 id=pg-88d0c5fd796be92ce5c7b6b01ec9223b>6 - Backlash Compensation</h1><div class=lead>Calibrating Backlash Compensation</div><p>Now we can have OpenPnP run its automatic backlash compensation routine to make all head movements more accurate. Read the OpenPnP docs page about this step <a href=https://github.com/openpnp/openpnp/wiki/Calibration-Solutions#calibrating-backlash-compensation>here</a>.</p><ol><li><p>First, we&rsquo;ll select the axis we want to calibrate backlash compensation for. Under the <code>Machine Setup</code> tab, select <code>ReferenceControllerAxis x</code> under <code>Axis</code>. Then select the <code>Backlash Compensation</code> tab.<figure><img src=https://docs.opulo.io/openpnp/calibration/backlash-compensation/images/Screen%20Shot%202022-05-18%20at%203.30.43%20PM_hu0735e200ce461230f87aee5c71f6c1cd_99211_800x600_fit_catmullrom_2.png alt></figure></p></li><li><p>Next, click the <code>Calibrate now</code> button. The machine will go through a long routine (between 5-15 minutes) where it measures the machine&rsquo;s backlash, and determines the best settings to account for it.</p></li><li><p>When it&rsquo;s done, you&rsquo;ll see the output data from the calibration. We suggest selecting <code>OneSidedPositioning</code> for the Compensation Method, but experiment with the different options to see which gives you the best results.<figure><img src=https://docs.opulo.io/openpnp/calibration/backlash-compensation/images/Screen%20Shot%202022-05-18%20at%203.32.55%20PM_hu7d95103c0d3171a68b53abd38d4a9ccd_422681_800x600_fit_catmullrom_2.png alt></figure></p></li><li><p>Perform steps 1 - 3 but with the Y axis instead.</p></li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-dccf766af7ea1fcd6571d19ee9d7f8be>7 - Nozzle Offset Calibration</h1><div class=lead>Calibrating the offset of the nozzle from the top camera</div><p>Now we need to tell OpenPnP how far the nozzle(s) is/are away from the center point of the top camera. OpenPnP has a built in &ldquo;wizard&rdquo; to help set this offset, so we&rsquo;ll use that to help us do it. You can read the OpenPnP docs about this step <a href=https://github.com/openpnp/openpnp/wiki/Setup-and-Calibration%3A-Nozzle-Setup#head-offsets>here</a>.</p><p><strong>NOTE:</strong> OpenPnP has some new methods of calibration using a secondary fiducial at a different Z height, and a small piece of paper. If you&rsquo;d like to explore this method of calibration, you can find the OpenPnP docs about this process <a href=https://github.com/openpnp/openpnp/wiki/Calibration-Solutions#calibrating-precision-camera-to-nozzle-offsets>here</a>. This process requires <a href=https://github.com/openpnp/openpnp/wiki/Vision-Solutions#calibration-rig>making and installing a calibration rig</a>, <a href=https://github.com/openpnp/openpnp/wiki/3D-Units-per-Pixel>3D Units per Pixel calibration</a>, and <a href=https://github.com/openpnp/openpnp/wiki/Advanced-Camera-Calibration>Advanced Camera Calibration</a>.</p><ol><li>Select your left nozzle (N1) in the device tree, and click on the <code>Offset Wizard</code> menu option. Leave the <code>Include Z?</code> box unchecked. Read the instructions that OpenPnP provides in this window.</li></ol><figure><img src=https://docs.opulo.io/openpnp/calibration/nozzle-offset/images/Screen%20Shot%202022-05-19%20at%202.17.07%20PM_hu2c3f27c5ca61363f9ae3e807d529615f_292370_800x600_fit_catmullrom_2.png alt></figure><ol start=2><li><p>You can follow OpenPnP&rsquo;s instructions using putty or flour, or you can use your homing fiducial. The rest of this page explains how to do this process with your homing fiducial.</p></li><li><p>Using an N045 nozzle tip, jog the nozzle so that it is just barely touching the datum board, and perfectly centered over the homing fiducial. We recommend looking for the shiny edge of the gold fiducial poking out from under the nozzle tip to determine if you&rsquo;ve centered it correctly.</p></li></ol><p><figure><img src=https://docs.opulo.io/openpnp/calibration/nozzle-offset/images/PXL_20220519_181926227_hu238a551825915b2d47e62b200377f5ab_1863021_800x600_fit_q75_catmullrom.jpg alt></figure><figure><img src=https://docs.opulo.io/openpnp/calibration/nozzle-offset/images/PXL_20220519_181952658_hub395d67e1c97ef54a48ae2fb0e34d7b9_1855359_800x600_fit_q75_catmullrom.jpg alt></figure></p><ol start=4><li>Now, click the <code>Store nozzle mark position</code> button.</li></ol><figure><img src=https://docs.opulo.io/openpnp/calibration/nozzle-offset/images/Screen%20Shot%202022-05-19%20at%202.20.06%20PM_hub357acc263f68c9dcf68a42edce38b73_33268_800x600_fit_catmullrom_2.png alt></figure><ol start=5><li>It&rsquo;s important that you don&rsquo;t navigate away from the nozzle menu in the device tree during this; it&rsquo;ll wipe your stored nozzle mark position. Now, jog the nozzle up, and jog the top camera to the homing fiducial. Center it exactly on the fiducial, and click the <code>Calculate nozzle offset</code> button. Hit the <code>Apply</code> button in the bottom right. You&rsquo;ve now stored the nozzle offset!</li></ol><figure><img src=https://docs.opulo.io/openpnp/calibration/nozzle-offset/images/Screen%20Shot%202022-05-19%20at%202.22.08%20PM_hu7ea48ed77743d02fccb12d69978298be_834999_800x600_fit_catmullrom_2.png alt></figure><ol start=6><li>If you have a <code>v3</code> machine, you have a second nozzle as well (N2). Perform the same steps above but for the second nozzle instead.</li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-a8eacac727b6db3e7a96dfb9e4f9cb5d>8 - Bottom Camera Position</h1><div class=lead>Setting the position of your bottom camera</div><p>Now that we know the offset from the top camera to the nozzle, we can use the nozzle to set our bottom camera position.</p><ol><li>Make sure that you have the N1 nozzle selected from the drop down beneath the camera view in OpenPnP.</li></ol><div class="alert alert-warning" role=alert><h4 class=alert-heading>Bottom Camera Z Position: v2 and v3 Differences</h4><p>For <code>v2</code> machines with only one nozzle, we have the bottom camera Z height that we lift the nozzle to for vision operations set to 61mm. This is very high up and lets us see very large parts, but if a second nozzle is installed, it can cause collisions.</p><p>For <code>v3</code> machines (that come with two nozzles), we&rsquo;ve dropped the camera a bit lower beneath the Staging Plate, and the height for bottom camera vision operations is 31.5mm. This ensures we can see large parts while preventing collisions with a second nozzle.</p><p>Make sure your bottom camera Z position is set correctly based on your version number.</p></div><ol start=2><li><p>Select the bottom camera in the device tree. Click on the <code>Position</code> menu tab. Click on the icon with the red nozzle in blue circle (shown below) to jog the nozzle to the bottom camera position.<figure><img src=https://docs.opulo.io/openpnp/calibration/bottom-camera-position/images/Screen%20Shot%202022-05-19%20at%202.53.57%20PM_hud2d13d47efa108ad7dedeadf28bc6c68_147579_800x600_fit_catmullrom_2.png alt></figure></p></li><li><p>The left nozzle will now move to be pretty close to the bottom camera inspection location, but it likely won&rsquo;t be exact. It&rsquo;s also possible that the tip of the nozzle is not in focus from the fisheye calibration step; adjust the bottom camera focus by turning the lens until the nozzle tip is sharp and in focus.<figure><img src=https://docs.opulo.io/openpnp/calibration/bottom-camera-position/images/Screen%20Shot%202022-05-19%20at%203.04.16%20PM_hu0861260bb59dc6ec1cfb70742578ad74_384517_800x600_fit_catmullrom_2.png alt></figure></p></li><li><p>Jog the nozzle to be perfectly centered over the bottom camera, and click on the blue nozzle icon to capture the position (see image below). Your bottom camera position is now saved!</p></li></ol><p><figure><img src=https://docs.opulo.io/openpnp/calibration/bottom-camera-position/images/Screen%20Shot%202022-05-19%20at%203.02.58%20PM_hu9a63fe8c10496a2af534a13ae791e289_362420_800x600_fit_catmullrom_2.png alt></figure><figure><img src=https://docs.opulo.io/openpnp/calibration/bottom-camera-position/images/capture_hud2d13d47efa108ad7dedeadf28bc6c68_147762_800x600_fit_catmullrom_2.png alt></figure></p></div><div class=td-content style=page-break-before:always><h1 id=pg-c944bf2771b5f1963cba78785de863e1>9 - Automatic Toolchanger Calibration</h1><div class=lead>Calibrating automatic toolchanger movements</div><p>Throughout the course of a job, you will find that you need multiple different size nozzle tips to pick different sized parts. You can always have OpenPnP prompt you to do this manually, but there&rsquo;s a feature for automatic nozzle swapping that can just do it for you! In this optional step, we&rsquo;ll set it up. Perform the following steps for each of the nozzle tips you&rsquo;d like to enable it for. We recommend reading the <a href=https://github.com/openpnp/openpnp/wiki/Nozzle-Tip-Changer>OpenPnP Wiki page</a> about this as well. Before starting, put the labeled nozzle tips into the holder in their respective labeled slots. Also make sure to lubricate the end of your nozzle holder with the lubrication packet included with your nozzles. It helps to insert the nozzle holder into all of the nozzle tips multiple times in order to break in the rubber O-rings, and lubricate the inside of the nozzle tips.</p><ol><li><p>Select the nozzle tip you&rsquo;re setting up under the <code>Nozzle Tips</code> menu in the device tree. Select the <code>Tool Changer</code> tab.</p></li><li><p>Now we can start capturing positions. The way automatic nozzle changing works is by replaying four position commands either forward or backward, to either load or unload a nozzle tip, respectively. We&rsquo;re going to start with the last position, because it&rsquo;s easiest for getting our Z height correct.</p></li><li><p>Jog your nozzle with the relevant nozzle tip loaded to just in front of your nozzle rack, in front of the slot for that nozzle tip. Adjust the Z height until it&rsquo;s clear it&rsquo;ll slide into the rack. Also ensure that it&rsquo;s aligned in the Y axis so that only a X movement would be necessary to slot it into place. Capture the nozzle position for the <code>Last Location</code>.</p></li><li><p>Now we&rsquo;re going to slowly jog the nozzle tip into the nozzle rack. Make sure you&rsquo;re only jogging in the X axis for a clean action. Jog by increments of 0.1mm until you see the nozzle tip pop completely into place. Try to ensure there&rsquo;s no lateral strain on the nozzle holder. If there is, we&rsquo;ll see this in a later step and can correct it then. Capture the <code>Third Location</code> nozzle position.</p></li><li><p>The next position is for making sure that the nozzle tip is completely seated on the CP40 holder during insertion. Jog the Z axis down two millimeters. This is not a hard and fast value, if you find that a larger or smaller value gets the nozzle tip seated completely, feel free to use that value instead. The spring in the CP40 holder will take up these few millimeters. Capture the <code>Second Location</code> nozzle position.</p></li><li><p>Now jog the Z axis up 30 millimeters. This is the clearance position where the nozzle holder is getting ready for the plunge. Capture the <code>First Location</code> nozzle position.</p></li><li><p>You can now play through the positions by clicking on the &ldquo;move nozzle to position&rdquo; buttons in order. Tune any values in the fields as necessary to ensure you get a clean and straight insertion.</p></li><li><p>Now that your positions are set, you can enable automatic tool changing in OpenPnP.</p></li><li><p>If you&rsquo;d like to clone these positions for every nozzle tip in the rack, you can use the <a href=https://github.com/openpnp/openpnp/wiki/Nozzle-Tip-Changer#cloning-settings>&ldquo;Cloning Settings&rdquo; section in the OpenPnP docs</a> to help you.</p></li></ol></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel="noopener noreferrer" href=https://twitter.com/stephen_hawes_><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Instagram aria-label=Instagram><a class=text-white target=_blank rel="noopener noreferrer" href=https://www.instagram.com/_stephen.hawes_/><i class="fab fa-instagram"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel="noopener noreferrer" href=https://github.com/opulo-inc/lumenpnp><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Discord aria-label=Discord><a class=text-white target=_blank rel="noopener noreferrer" href=https://discordapp.com/invite/TCwy6De><i class="fab fa-discord"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js integrity=sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s crossorigin=anonymous></script><script src=/js/main.min.f820bfc507c3ebefe17f8881ec4ee10013f3b89ad9555a50acf9bb1771e6823f.js integrity="sha256-+CC/xQfD6+/hf4iB7E7hABPzuJrZVVpQrPm7F3Hmgj8=" crossorigin=anonymous></script></body></html>